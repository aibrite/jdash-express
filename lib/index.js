"use strict";var moment=require("moment"),JDashApi=function(){function t(t){this.options=t,this.provider=t.provider}return t.prototype.handleError=function(t){},t.prototype.deleteDashletRoute=function(t,e,i){var o=t.params.id;this.options.principal(t);this.provider.deleteDashlet(o).then(function(){return e.sendStatus(200)}).catch(function(t){return i(t)})},t.prototype.saveDashletRoute=function(t,e,i){var o=(this.options.principal(t),t.params.id),r=t.body;this.provider.updateDashlet(o,r).then(function(t){return e.sendStatus(200)}).catch(function(t){return i(t)})},t.prototype.createDashletRoute=function(t,e,i){var o=t.body,r=(this.options.principal(t),{title:o.title,configuration:o.configuration,description:o.description,createdAt:moment().utc().toDate(),dashboardId:o.dashboardId,moduleId:o.moduleId});this.provider.createDashlet(r).then(function(t){return e.send(t)}).catch(function(t){return i(t)})},t.prototype.saveDashboardRoute=function(t,e,i){var o=this.options.principal(t),r=t.params.id,a=t.body;this.provider.updateDashboard(o.appid,r,a).then(function(t){return e.sendStatus(200)}).catch(function(t){return i(t)})},t.prototype.getMyDashboardRoute=function(t,e,i){var o=this.options.principal(t);this.provider.searchDashboards({appid:o.appid,user:o.user}).then(function(t){return e.send(t)})},t.prototype.deleteDashboardRoute=function(t,e,i){var o=t.params.id,r=this.options.principal(t);this.provider.deleteDashboard(r.appid,o).then(function(){return e.sendStatus(200)}).catch(function(t){return i(t)})},t.prototype.searchDashboardsRoute=function(t,e,i){var o=this.options.principal(t),r=t.body.search,a=t.body.query;this.provider.searchDashboards({appid:o.appid,shareWith:r.shareWith,user:r.user},a).then(function(t){return e.send(t)})},t.prototype.createDashboardRoute=function(t,e,i){var o=this.options.principal(t),r=t.body,a={title:r.title,appid:o.appid,config:r.config,createdAt:moment().utc().toDate(),description:r.description,layout:r.layout,shareWith:r.shareWith,user:o.user,id:null};this.provider.createDashboard(a).then(function(t){return e.send(t)}).catch(function(t){return i(t)})},t.prototype.getDashboardRoute=function(t,e,i){var o=t.params.id,r=this.options.principal(t);this.provider.getDashboard(r.appid,o).then(function(t){return e.send(t)}).catch(function(t){return i(t)})},t.prototype.use=function(t){return t.get("/dashboard/my",this.getMyDashboardRoute.bind(this)),t.get("/dashboard/:id",this.getDashboardRoute.bind(this)),t.post("/dashboard/create",this.createDashboardRoute.bind(this)),t.post("/dashboard/search",this.searchDashboardsRoute.bind(this)),t.post("/dashboard/delete/:id",this.deleteDashboardRoute.bind(this)),t.post("/dashboard/save/:id",this.saveDashboardRoute.bind(this)),t.post("/dashlet/create",this.createDashletRoute.bind(this)),t.post("/dashlet/delete/:id",this.deleteDashletRoute.bind(this)),t.post("/dashlet/save/:id",this.saveDashletRoute.bind(this)),this},t}();exports.JDashApi=JDashApi,Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(t){return new JDashApi(t)};